<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="twitter:image:src" content="https://leimao.github.io/images/favicon/android-chrome-512x512.png"><meta name="referrer" content="no-referrer-when-downgrade"><title>C++ Function Call Performance - Lei Mao&#039;s Log Book</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="Lei Mao&#039;s Log Book"><meta name="msapplication-TileImage" content="/images/favicon/android-chrome-192x192.png"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lei Mao&#039;s Log Book"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="192x192" href="/images/favicon/android-chrome-192x192.png"><link rel="apple-touch-icon" sizes="512x512" href="/images/favicon/android-chrome-512x512.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="apple-touch-icon" sizes="32x32" href="/images/favicon/favicon-32x32.png"><meta name="description" content="Performance Caveats of Passing Functions as Arguments in C++"><meta property="og:type" content="blog"><meta property="og:title" content="C++ Function Call Performance"><meta property="og:url" content="https://leimao.github.io/blog/CPP-Function-Call-Performance/"><meta property="og:site_name" content="Lei Mao&#039;s Log Book"><meta property="og:description" content="Performance Caveats of Passing Functions as Arguments in C++"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://leimao.github.io/images/favicon/android-chrome-512x512.png"><meta property="article:published_time" content="2023-11-13T08:00:00.000Z"><meta property="article:modified_time" content="2023-11-13T08:00:00.000Z"><meta property="article:author" content="Lei Mao"><meta property="article:tag" content="CPP"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://leimao.github.io/images/favicon/android-chrome-512x512.png"><meta property="twitter:creator" content="@matchaleimao"><meta property="twitter:site" content="Lei Mao&#039;s Log Book"><meta property="fb:admins" content="dukeleimao"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://leimao.github.io/blog/CPP-Function-Call-Performance/"},"headline":"C++ Function Call Performance","image":["https://leimao.github.io/images/favicon/android-chrome-512x512.png"],"datePublished":"2023-11-13T08:00:00.000Z","dateModified":"2023-11-13T08:00:00.000Z","author":{"@type":"Person","name":"Lei Mao"},"publisher":{"@type":"Organization","name":"Lei Mao's Log Book","logo":{"@type":"ImageObject","url":"https://leimao.github.io/images/favicon/android-chrome-512x512.png"}},"description":"Performance Caveats of Passing Functions as Arguments in C++"}</script><link rel="canonical" href="https://leimao.github.io/blog/CPP-Function-Call-Performance/"><link rel="alternate" href="/atom.xml" title="Lei Mao&#039;s Log Book" type="application/atom+xml"><link rel="icon" href="/images/favicon/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons/css/academicons.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=PT+Sans+Narrow:wght@400;700&amp;family=PT+Serif"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-EJY6FXZBCB" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-EJY6FXZBCB');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script src="//m.servedby-buysellads.com/monetization.custom.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/favicon/android-chrome-512x512.png" alt="Lei Mao&#039;s Log Book" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Lei Mao&#039;s Log Book</a><a class="navbar-item" href="/curriculum">Curriculum</a><a class="navbar-item" href="/blog">Blog</a><a class="navbar-item" href="/article">Articles</a><a class="navbar-item" href="/project">Projects</a><a class="navbar-item" href="/publication">Publications</a><a class="navbar-item" href="/reading">Readings</a><a class="navbar-item" href="/life">Life</a><a class="navbar-item" href="/essay">Essay</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/faq">FAQs</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Switch Color Scheme" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/leimao"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Gitter" href="https://gitter.im/leimao/community"><i class="fab fa-gitter"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-content"><center><div class="bsa-standard" id="carbon-ad-01"></div><script>            (function() {             if (typeof _bsa !== 'undefined' && _bsa) {                 _bsa.init('custom', 'CWYD65QY', 'placement:leimaogithubio-standard', {                     target: '#carbon-ad-01',                     template: `             <a href='##link##' class='native-banner' style='background: ##backgroundColor##' rel='sponsored noopener' target='_blank' title='##company## — ##tagline##'>                 <img class='native-img' width='125' src='##logo##' />                 <div class='native-main'>                     <div class='native-details' style='                             color: ##textColor##;                             border-left: solid 1px ##textColor##;                         '>                         <span class='native-company'>Sponsored by ##company##</span>                         <span class='native-desc'>##description##</span>                     </div>                     <span class='native-cta' style='                             color: ##ctaTextColor##;                             background-color: ##ctaBackgroundColor##;                         '>##callToAction##</span>                 </div>             </a>             `,                 });                 }             })();         </script></center></div></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3" style="font-family: 'PT Sans Narrow', sans-serif">C++ Function Call Performance</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left" style="margin-bottom: 0.50rem"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2023-11-13T08:00:00.000Z" title="2023-11-13T08:00:00.000Z">11-13-2023</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="2023-11-13T08:00:00.000Z" title="2023-11-13T08:00:00.000Z">11-13-2023</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/blog/">blog</a></span><span class="level-item"><i class="far fa-clock"></i> 10 minutes read (About 1441 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>&nbsp;visits</span></div></div><div class="content" style="margin-top: 1.0rem"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In a C++ project, to reduce code duplication and make the code more modular, we often pass functions as arguments to other functions. There are usually several ways to pass functions as arguments in C++: function pointer, <code>std::function</code>, and lambda function.</p>
<p>In this blog post, we will discuss the performance caveats of passing functions as arguments in C++.</p>
<h2 id="Performances"><a href="#Performances" class="headerlink" title="Performances"></a>Performances</h2><p>We will call a simple and fast function <code>add_one</code> frequently to measure the performance of different ways of passing functions as arguments.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cassert&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add_one</span><span class="params">(<span class="type">int</span> input)</span> </span>&#123; <span class="keyword">return</span> input + <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">validate_vector_add_one</span><span class="params">(std::vector&lt;<span class="type">int</span>&gt; <span class="type">const</span>&amp; input_vector,</span></span></span><br><span class="line"><span class="params"><span class="function">                             std::vector&lt;<span class="type">int</span>&gt; <span class="type">const</span>&amp; output_vector)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">bool</span> is_valid&#123;<span class="literal">true</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; input_vector.<span class="built_in">size</span>(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (output_vector.<span class="built_in">at</span>(i) != input_vector.<span class="built_in">at</span>(i) + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            is_valid = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> is_valid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reset_vector</span><span class="params">(std::vector&lt;<span class="type">int</span>&gt;&amp; input_vector)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; input_vector.<span class="built_in">size</span>(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        input_vector.<span class="built_in">at</span>(i) = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Func&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unitary_function_pass_by_lambda_function</span><span class="params">(T&amp; output, T <span class="type">const</span>&amp; input,</span></span></span><br><span class="line"><span class="params"><span class="function">                                              Func <span class="type">const</span> func)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    output = <span class="built_in">func</span>(input);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unitary_function_pass_by_std_function_value</span><span class="params">(T&amp; output, T <span class="type">const</span>&amp; input,</span></span></span><br><span class="line"><span class="params"><span class="function">                                                 std::function&lt;T(T)&gt; <span class="type">const</span> func)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    output = <span class="built_in">func</span>(input);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unitary_function_pass_by_std_function_reference</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    T&amp; output, T <span class="type">const</span>&amp; input, std::function&lt;T(T)&gt; <span class="type">const</span>&amp; func)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    output = <span class="built_in">func</span>(input);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unitary_function_pass_by_function_pointer</span><span class="params">(T&amp; output, T <span class="type">const</span>&amp; input,</span></span></span><br><span class="line"><span class="params"><span class="function">                                               T (*func)(T))</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    output = <span class="built_in">func</span>(input);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Set floating point format std::cout with 3 decimal places.</span></span><br><span class="line">    std::cout.<span class="built_in">precision</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> <span class="type">const</span> num_elements&#123;<span class="number">10000000</span>&#125;;</span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">input_vector</span><span class="params">(num_elements, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">output_vector</span><span class="params">(num_elements, <span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> <span class="type">const</span> lambda_function_add_one&#123;[](<span class="type">int</span> <span class="type">const</span>&amp; input) -&gt; <span class="type">int</span></span><br><span class="line">                                       &#123; <span class="keyword">return</span> input + <span class="number">1</span>; &#125;&#125;;</span><br><span class="line">    std::function&lt;<span class="type">int</span>(<span class="type">int</span>)&gt; <span class="type">const</span> std_function_add_one&#123;lambda_function_add_one&#125;;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;The size of a function pointer: &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(&amp;add_one)</span><br><span class="line">              &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;The size of a std::function pointer: &quot;</span></span><br><span class="line">              &lt;&lt; <span class="built_in">sizeof</span>(&amp;std_function_add_one) &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;The size of a std::function: &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(std_function_add_one)</span><br><span class="line">              &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Call function frequently in a vanilla way.</span></span><br><span class="line">    <span class="comment">// The compiler knows what function to call at compile time and can optimize</span></span><br><span class="line">    <span class="comment">// the code.</span></span><br><span class="line">    <span class="comment">// This is the best performance we could get.</span></span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span> time_start_vanilla&#123;</span><br><span class="line">        std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; num_elements; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        output_vector.<span class="built_in">at</span>(i) = <span class="built_in">add_one</span>(input_vector.<span class="built_in">at</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span> time_end_vanilla&#123;</span><br><span class="line">        std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">auto</span> <span class="type">const</span> time_elapsed_vanilla&#123;</span><br><span class="line">        std::chrono::<span class="built_in">duration_cast</span>&lt;std::chrono::nanoseconds&gt;(time_end_vanilla -</span><br><span class="line">                                                             time_start_vanilla)</span><br><span class="line">            .<span class="built_in">count</span>()&#125;;</span><br><span class="line">    <span class="type">float</span> <span class="type">const</span> latency_vanilla&#123;time_elapsed_vanilla /</span><br><span class="line">                                <span class="built_in">static_cast</span>&lt;<span class="type">float</span>&gt;(num_elements)&#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Latency Pass Vanilla: &quot;</span> &lt;&lt; latency_vanilla &lt;&lt; <span class="string">&quot; ns&quot;</span></span><br><span class="line">              &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">validate_vector_add_one</span>(input_vector, output_vector));</span><br><span class="line">    <span class="built_in">reset_vector</span>(output_vector);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sometimes, we don&#x27;t know what function to call at compile time.</span></span><br><span class="line">    <span class="comment">// We can use std::function to pass a function as an argument.</span></span><br><span class="line">    <span class="comment">// In this case, we pass the std::function by value.</span></span><br><span class="line">    <span class="comment">// Because the size of a std::function is 32 bytes, passing by value</span></span><br><span class="line">    <span class="comment">// results in a lot of copying and bad performance.</span></span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_start_pass_by_std_function_value&#123;std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; num_elements; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">unitary_function_pass_by_std_function_value</span>(</span><br><span class="line">            output_vector.<span class="built_in">at</span>(i), input_vector.<span class="built_in">at</span>(i), std_function_add_one);</span><br><span class="line">    &#125;</span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_end_pass_by_std_function_value&#123;std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">auto</span> <span class="type">const</span> time_elapsed_pass_by_std_function_value&#123;</span><br><span class="line">        std::chrono::<span class="built_in">duration_cast</span>&lt;std::chrono::nanoseconds&gt;(</span><br><span class="line">            time_end_pass_by_std_function_value -</span><br><span class="line">            time_start_pass_by_std_function_value)</span><br><span class="line">            .<span class="built_in">count</span>()&#125;;</span><br><span class="line">    <span class="type">float</span> <span class="type">const</span> latency_pass_by_std_function_value&#123;</span><br><span class="line">        time_elapsed_pass_by_std_function_value /</span><br><span class="line">        <span class="built_in">static_cast</span>&lt;<span class="type">float</span>&gt;(num_elements)&#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Latency Pass By Std Function Value: &quot;</span></span><br><span class="line">              &lt;&lt; latency_pass_by_std_function_value &lt;&lt; <span class="string">&quot; ns&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">validate_vector_add_one</span>(input_vector, output_vector));</span><br><span class="line">    <span class="built_in">reset_vector</span>(output_vector);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Instead of passing the std::function by value, we can pass it by</span></span><br><span class="line">    <span class="comment">// reference (pointer). In this case, object copying is eliminated. The</span></span><br><span class="line">    <span class="comment">// performance is better than passing the std::function by value. However,</span></span><br><span class="line">    <span class="comment">// the performance is still not as good as the vanilla way.</span></span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_start_pass_by_std_function_reference&#123;</span><br><span class="line">            std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; num_elements; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">unitary_function_pass_by_std_function_reference</span>(</span><br><span class="line">            output_vector.<span class="built_in">at</span>(i), input_vector.<span class="built_in">at</span>(i), std_function_add_one);</span><br><span class="line">    &#125;</span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_end_pass_by_std_function_reference&#123;</span><br><span class="line">            std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">auto</span> <span class="type">const</span> time_elapsed_pass_by_std_function_reference&#123;</span><br><span class="line">        std::chrono::<span class="built_in">duration_cast</span>&lt;std::chrono::nanoseconds&gt;(</span><br><span class="line">            time_end_pass_by_std_function_reference -</span><br><span class="line">            time_start_pass_by_std_function_reference)</span><br><span class="line">            .<span class="built_in">count</span>()&#125;;</span><br><span class="line">    <span class="type">float</span> <span class="type">const</span> latency_pass_by_std_function_reference&#123;</span><br><span class="line">        time_elapsed_pass_by_std_function_reference /</span><br><span class="line">        <span class="built_in">static_cast</span>&lt;<span class="type">float</span>&gt;(num_elements)&#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Latency Pass By Std Function Reference: &quot;</span></span><br><span class="line">              &lt;&lt; latency_pass_by_std_function_reference &lt;&lt; <span class="string">&quot; ns&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">validate_vector_add_one</span>(input_vector, output_vector));</span><br><span class="line">    <span class="built_in">reset_vector</span>(output_vector);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::function is a general purpose wrapper for function pointers,</span></span><br><span class="line">    <span class="comment">// callable objects, and lambda functions. Because it&#x27;s general purpose,</span></span><br><span class="line">    <span class="comment">// it&#x27;s not as efficient as a function pointer. In this case, we pass a</span></span><br><span class="line">    <span class="comment">// function pointer to a function. The performance is better than passing</span></span><br><span class="line">    <span class="comment">// the std::function by reference.</span></span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_start_pass_by_function_pointer&#123;std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; num_elements; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">unitary_function_pass_by_function_pointer</span>(output_vector.<span class="built_in">at</span>(i),</span><br><span class="line">                                                  input_vector.<span class="built_in">at</span>(i), &amp;add_one);</span><br><span class="line">    &#125;</span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_end_pass_by_function_pointer&#123;std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">auto</span> <span class="type">const</span> time_elapsed_pass_by_function_pointer&#123;</span><br><span class="line">        std::chrono::<span class="built_in">duration_cast</span>&lt;std::chrono::nanoseconds&gt;(</span><br><span class="line">            time_end_pass_by_function_pointer -</span><br><span class="line">            time_start_pass_by_function_pointer)</span><br><span class="line">            .<span class="built_in">count</span>()&#125;;</span><br><span class="line">    <span class="type">float</span> <span class="type">const</span> latency_pass_by_function_pointer&#123;</span><br><span class="line">        time_elapsed_pass_by_function_pointer /</span><br><span class="line">        <span class="built_in">static_cast</span>&lt;<span class="type">float</span>&gt;(num_elements)&#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Latency Pass By Function Pointer: &quot;</span></span><br><span class="line">              &lt;&lt; latency_pass_by_function_pointer &lt;&lt; <span class="string">&quot; ns&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">validate_vector_add_one</span>(input_vector, output_vector));</span><br><span class="line">    <span class="built_in">reset_vector</span>(output_vector);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We can also pass a lambda function to a function.</span></span><br><span class="line">    <span class="comment">// The compiler knows what function to call at compile time and can optimize</span></span><br><span class="line">    <span class="comment">// the code. The performance is also better than passing the std::function</span></span><br><span class="line">    <span class="comment">// by reference.</span></span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_start_pass_by_lambda_function&#123;std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i&#123;<span class="number">0</span>&#125;; i &lt; num_elements; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">unitary_function_pass_by_lambda_function</span>(</span><br><span class="line">            output_vector.<span class="built_in">at</span>(i), input_vector.<span class="built_in">at</span>(i), lambda_function_add_one);</span><br><span class="line">    &#125;</span><br><span class="line">    std::chrono::steady_clock::time_point <span class="type">const</span></span><br><span class="line">        time_end_pass_by_lambda_function&#123;std::chrono::steady_clock::<span class="built_in">now</span>()&#125;;</span><br><span class="line">    <span class="keyword">auto</span> <span class="type">const</span> time_elapsed_pass_by_lambda_function&#123;</span><br><span class="line">        std::chrono::<span class="built_in">duration_cast</span>&lt;std::chrono::nanoseconds&gt;(</span><br><span class="line">            time_end_pass_by_lambda_function -</span><br><span class="line">            time_start_pass_by_lambda_function)</span><br><span class="line">            .<span class="built_in">count</span>()&#125;;</span><br><span class="line">    <span class="type">float</span> <span class="type">const</span> latency_pass_by_lambda_function&#123;</span><br><span class="line">        time_elapsed_pass_by_lambda_function /</span><br><span class="line">        <span class="built_in">static_cast</span>&lt;<span class="type">float</span>&gt;(num_elements)&#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Latency Pass By Lambda Function: &quot;</span></span><br><span class="line">              &lt;&lt; latency_pass_by_lambda_function &lt;&lt; <span class="string">&quot; ns&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">validate_vector_add_one</span>(input_vector, output_vector));</span><br><span class="line">    <span class="built_in">reset_vector</span>(output_vector);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When the code is compiled using GCC with <code>-O0</code>, the performance is as follows.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ g++ function_call_performance.cpp -o function_call_performance -std=c++14 -O0</span><br><span class="line">$ ./function_call_performance</span><br><span class="line">The size of a <span class="keyword">function</span> pointer: 8</span><br><span class="line">The size of a std::<span class="keyword">function</span> pointer: 8</span><br><span class="line">The size of a std::<span class="keyword">function</span>: 32</span><br><span class="line">Latency Pass Vanilla: 14.6 ns</span><br><span class="line">Latency Pass By Std Function Value: 84.4 ns</span><br><span class="line">Latency Pass By Std Function Reference: 39.4 ns</span><br><span class="line">Latency Pass By Function Pointer: 17.5 ns</span><br><span class="line">Latency Pass By Lambda Function: 17.5 ns</span><br></pre></td></tr></table></figure>

<p>When the code is compiled using GCC with <code>-O3</code>, the performance is as follows.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ g++ function_call_performance.cpp -o function_call_performance -std=c++14 -O3</span><br><span class="line">$ ./function_call_performance</span><br><span class="line">The size of a <span class="keyword">function</span> pointer: 8</span><br><span class="line">The size of a std::<span class="keyword">function</span> pointer: 8</span><br><span class="line">The size of a std::<span class="keyword">function</span>: 32</span><br><span class="line">Latency Pass Vanilla: 0.354 ns</span><br><span class="line">Latency Pass By Std Function Value: 5.06 ns</span><br><span class="line">Latency Pass By Std Function Reference: 1.91 ns</span><br><span class="line">Latency Pass By Function Pointer: 0.387 ns</span><br><span class="line">Latency Pass By Lambda Function: 0.413 ns</span><br></pre></td></tr></table></figure>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Using <code>std::function</code> to pass functions as arguments is convenient. However, it’s not as efficient as using function pointers or lambda functions. If performance is critical, especially when the function is fast to compute and is called frequently, we should avoid using <code>std::function</code>.</p>
<p>For the best performance, we should use function pointers or lambda functions to pass functions as arguments.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="/blog/CPP-std-function/">C++ General-Purpose Polymorphic Function Wrapper</a></li>
<li><a href="/blog/C-Function-Pointer/">C/C++ Function Pointer</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>C++ Function Call Performance</p><p><a href="https://leimao.github.io/blog/CPP-Function-Call-Performance/">https://leimao.github.io/blog/CPP-Function-Call-Performance/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Lei Mao</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>11-13-2023</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>11-13-2023</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <div><a class="link-muted" rel="tag" href="/tags/CPP/">CPP </a> </div></div></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=61b5930d440224001908310c&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered has-text-weight-normal">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="paypal" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="SSVSLEH4X85LU"><input type="hidden" name="currency_code" value="USD"></form><a class="button donate" href="https://www.buymeacoffee.com/leimao" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/essay/%E4%B8%AD%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">我中学时的计算机课</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/life/Del-Valle-Regional-Park-North/"><span class="level-item">Del Valle Regional Park North 徒步</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comment-card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="comment-block"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://leimao.github.io/blog/CPP-Function-Call-Performance/';
            this.page.identifier = '/blog/CPP-Function-Call-Performance/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'leimao-github-io' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/author_images/Lei-Bio-Medium.jpg" alt="Lei Mao"></figure><p class="title is-size-4 is-block" style="line-height:inherit;margin-bottom:0.30rem;">Lei Mao</p><p class="is-block" style="white-space: pre-line; font-style: italic; margin-bottom: 0.50rem; font-size: 0.8em">Artificial Intelligence
Machine Learning
Computer Science
</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Santa Clara, California</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">733</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">453</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/leimao" target="_blank" rel="noopener"><i class="fab fa-github"></i>  Follow</a> <a class="level-item button is-primary is-rounded" href="https://github.com/sponsors/leimao" target="_blank" rel="noopener"><i class="fas fa-heart"></i>  Sponsor</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/leimao"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/matchaleimao"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/lei-mao/"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:dukeleimao@gmail.com"><i class="fas fa-envelope-square"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="G.Scholar" href="https://scholar.google.com/citations?user=R2VUf7YAAAAJ"><i class="ai ai-google-scholar-square"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Introduction"><span class="level-left"><span class="level-item">1</span><span class="level-item">Introduction</span></span></a></li><li><a class="level is-mobile" href="#Performances"><span class="level-left"><span class="level-item">2</span><span class="level-item">Performances</span></span></a></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">3</span><span class="level-item">Conclusion</span></span></a></li><li><a class="level is-mobile" href="#References"><span class="level-left"><span class="level-item">4</span><span class="level-item">References</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget"><div class="g-ads-x"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3></div><br><center><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDCK3L&amp;placement=leimaogithubio" id="_carbonads_js"></script></center></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/favicon/android-chrome-512x512.png" alt="Lei Mao&#039;s Log Book" height="28"></a><p class="is-size-7"><span>&copy; 2017-2024 Lei Mao</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Site UV: <span id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></span></span> <span id="busuanzi_container_site_pv">Site PV: <span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span></span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/leimao"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>