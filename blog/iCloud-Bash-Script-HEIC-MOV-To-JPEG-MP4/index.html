<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="twitter:image:src" content="https://levanliu.github.io/images/favicon/android-chrome-512x512.png"><meta name="referrer" content="no-referrer-when-downgrade"><title>iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion - Lei Mao&#039;s Log Book</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="Lei Mao&#039;s Log Book"><meta name="msapplication-TileImage" content="/images/favicon/android-chrome-192x192.png"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lei Mao&#039;s Log Book"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="192x192" href="/images/favicon/android-chrome-192x192.png"><link rel="apple-touch-icon" sizes="512x512" href="/images/favicon/android-chrome-512x512.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="apple-touch-icon" sizes="32x32" href="/images/favicon/favicon-32x32.png"><meta name="description" content="Replacing the Crappy iCloud Download Interface"><meta property="og:type" content="blog"><meta property="og:title" content="iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion"><meta property="og:url" content="https://levanliu.github.io/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/"><meta property="og:site_name" content="Lei Mao&#039;s Log Book"><meta property="og:description" content="Replacing the Crappy iCloud Download Interface"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://levanliu.github.io/images/blog/2023-10-11-iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/icloud.png"><meta property="article:published_time" content="2023-10-11T07:00:00.000Z"><meta property="article:modified_time" content="2023-10-11T07:00:00.000Z"><meta property="article:author" content="Lei Mao"><meta property="article:tag" content="Apple"><meta property="article:tag" content="iCloud"><meta property="article:tag" content="FFMPEG"><meta property="article:tag" content="ImageMagick"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://levanliu.github.io/images/blog/2023-10-11-iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/icloud.png"><meta property="twitter:creator" content="@matchalevanliu"><meta property="twitter:site" content="Lei Mao&#039;s Log Book"><meta property="fb:admins" content="dukelevanliu"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://levanliu.github.io/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/"},"headline":"iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion","image":["https://levanliu.github.io/images/blog/2023-10-11-iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/icloud.png"],"datePublished":"2023-10-11T07:00:00.000Z","dateModified":"2023-10-11T07:00:00.000Z","author":{"@type":"Person","name":"Lei Mao"},"publisher":{"@type":"Organization","name":"Lei Mao's Log Book","logo":{"@type":"ImageObject","url":"https://levanliu.github.io/images/favicon/android-chrome-512x512.png"}},"description":"Replacing the Crappy iCloud Download Interface"}</script><link rel="canonical" href="https://levanliu.github.io/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/"><link rel="alternate" href="/atom.xml" title="Lei Mao&#039;s Log Book" type="application/atom+xml"><link rel="icon" href="/images/favicon/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons/css/academicons.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=PT+Sans+Narrow:wght@400;700&amp;family=PT+Serif"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-EJY6FXZBCB" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-EJY6FXZBCB');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script src="//m.servedby-buysellads.com/monetization.custom.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/favicon/android-chrome-512x512.png" alt="Lei Mao&#039;s Log Book" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Lei Mao&#039;s Log Book</a><a class="navbar-item" href="/curriculum">Curriculum</a><a class="navbar-item" href="/blog">Blog</a><a class="navbar-item" href="/article">Articles</a><a class="navbar-item" href="/project">Projects</a><a class="navbar-item" href="/publication">Publications</a><a class="navbar-item" href="/reading">Readings</a><a class="navbar-item" href="/life">Life</a><a class="navbar-item" href="/essay">Essay</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/faq">FAQs</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Switch Color Scheme" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/levanliu"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Gitter" href="https://gitter.im/levanliu/community"><i class="fab fa-gitter"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-content"><center><div class="bsa-standard" id="carbon-ad-01"></div><script>            (function() {             if (typeof _bsa !== 'undefined' && _bsa) {                 _bsa.init('custom', 'CWYD65QY', 'placement:levanliugithubio-standard', {                     target: '#carbon-ad-01',                     template: `             <a href='##link##' class='native-banner' style='background: ##backgroundColor##' rel='sponsored noopener' target='_blank' title='##company## — ##tagline##'>                 <img class='native-img' width='125' src='##logo##' />                 <div class='native-main'>                     <div class='native-details' style='                             color: ##textColor##;                             border-left: solid 1px ##textColor##;                         '>                         <span class='native-company'>Sponsored by ##company##</span>                         <span class='native-desc'>##description##</span>                     </div>                     <span class='native-cta' style='                             color: ##ctaTextColor##;                             background-color: ##ctaBackgroundColor##;                         '>##callToAction##</span>                 </div>             </a>             `,                 });                 }             })();         </script></center></div></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3" style="font-family: 'PT Sans Narrow', sans-serif">iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left" style="margin-bottom: 0.50rem"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2023-10-11T07:00:00.000Z" title="2023-10-11T07:00:00.000Z">10-11-2023</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="2023-10-11T07:00:00.000Z" title="2023-10-11T07:00:00.000Z">10-11-2023</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/blog/">blog</a></span><span class="level-item"><i class="far fa-clock"></i> 6 minutes read (About 830 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>&nbsp;visits</span></div></div><div class="content" style="margin-top: 1.0rem"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Two weeks ago, I found that I could not download zipped JPEG/MP4 file anymore. Even if I clicked the “Most Compatible” option, the zipped file I downloaded would only contain HEIC/MOV files.</p>
<img src="/images/blog/2023-10-11-iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/icloud.png" class="box px-0 py-0 ml-auto mr-auto" width="480" title="iCloud Browser File Download Interface" alt="iCloud Browser Download Interface">
<br>

<p>At first, I thought it was a bug and could be fixed soon. But after two weeks, it still did not work. On <a target="_blank" rel="noopener" href="https://www.reddit.com/r/iCloud/comments/16v0q2j/icloud_photos_defaulting_to_zipheic_download_in/">Reddit</a>, many people have also found this issue and reached out to Apple. However, the response they got from Apple is that it is the expected behavior and there is a chance that it will never be reverted. This means I will have to convert HEIC/MOV files to JPEG/MP4 files manually.</p>
<p>In this blog post, I created a bash script for converting HEIC/MOV files to JPEG/MP4 files on Linux systems.</p>
<h2 id="iCloud-HEIC-MOV-To-JPEG-MP4-Bash-Script-Conversion"><a href="#iCloud-HEIC-MOV-To-JPEG-MP4-Bash-Script-Conversion" class="headerlink" title="iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion"></a>iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion</h2><p>With some assistance from ChatGPT, I created the following bash script for converting HEIC/MOV files downloaded from iCloud to JPEG/MP4 files. It assumes FFMPEG and ImageMagick are installed.</p>
<p>To install FFMPEG and ImageMagick on Ubuntu, run the following command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt update</span><br><span class="line">$ sudo apt install ffmpeg imagemagick</span><br></pre></td></tr></table></figure>

<p>The bash script is as follows.</p>
<figure class="highlight bash"><figcaption><span>convert.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Default value for verbosity (suppress FFmpeg outputs)</span></span><br><span class="line">verbosity=<span class="string">&quot;-v quiet&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check if ffmpeg and convert (from ImageMagick) are installed</span></span><br><span class="line"><span class="keyword">if</span> ! <span class="built_in">command</span> -v ffmpeg &amp;&gt; /dev/null || ! <span class="built_in">command</span> -v convert &amp;&gt; /dev/null; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Please install ffmpeg and ImageMagick before running this script.&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set default resolutions</span></span><br><span class="line">heic_resolution=<span class="string">&quot;2048x1536&quot;</span></span><br><span class="line">mov_resolution=<span class="string">&quot;1280x720&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Parse command line arguments</span></span><br><span class="line"><span class="keyword">while</span> [[ <span class="variable">$#</span> -gt 0 ]]; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">        -i|--input)</span><br><span class="line">            input_dir=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">            <span class="built_in">shift</span> 2</span><br><span class="line">            ;;</span><br><span class="line">        -o|--output)</span><br><span class="line">            output_dir=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">            <span class="built_in">shift</span> 2</span><br><span class="line">            ;;</span><br><span class="line">        -hr|--heic-resolution)</span><br><span class="line">            heic_resolution=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">            <span class="built_in">shift</span> 2</span><br><span class="line">            ;;</span><br><span class="line">        -mr|--mov-resolution)</span><br><span class="line">            mov_resolution=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">            <span class="built_in">shift</span> 2</span><br><span class="line">            ;;</span><br><span class="line">        -v|--verbosity)</span><br><span class="line">            verbosity=<span class="string">&quot;&quot;</span>  <span class="comment"># Enable FFmpeg console outputs</span></span><br><span class="line">            <span class="built_in">shift</span></span><br><span class="line">            ;;</span><br><span class="line">        *)</span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;Unknown argument: <span class="variable">$1</span>&quot;</span></span><br><span class="line">            <span class="built_in">exit</span> 1</span><br><span class="line">            ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check if input and output directories are provided</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$input_dir</span>&quot;</span> ] || [ -z <span class="string">&quot;<span class="variable">$output_dir</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Usage: ./convert.sh -i &lt;input_dir&gt; -o &lt;output_dir&gt; [-hr &lt;heic_resolution&gt;] [-mr &lt;mov_resolution&gt;] [-v]&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the output directory if it doesn&#x27;t exist</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$output_dir</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert HEIC to JPEG or heic to jpeg</span></span><br><span class="line"><span class="keyword">for</span> heic_file <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$input_dir</span>&quot;</span>/*.[Hh][Ee][Ii][Cc]; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="string">&quot;<span class="variable">$heic_file</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        base_name=<span class="string">&quot;<span class="subst">$(basename <span class="string">&quot;<span class="variable">$heic_file</span>&quot;</span> | sed &#x27;s/\(.*\)\.[Hh][Ee][Ii][Cc]/\1/&#x27;)</span>&quot;</span></span><br><span class="line">        ext=<span class="string">&quot;<span class="subst">$(basename <span class="string">&quot;<span class="variable">$heic_file</span>&quot;</span> | sed &#x27;s/.*\.\([Hh][Ee][Ii][Cc]\)/\1/&#x27;)</span>&quot;</span></span><br><span class="line">        <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$ext</span>&quot;</span> == <span class="string">&quot;HEIC&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            output_ext=<span class="string">&quot;JPEG&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$ext</span>&quot;</span> == <span class="string">&quot;heic&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            output_ext=<span class="string">&quot;jpeg&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        output_file=<span class="string">&quot;<span class="variable">$output_dir</span>/<span class="variable">$base_name</span>.<span class="variable">$output_ext</span>&quot;</span></span><br><span class="line">        convert <span class="string">&quot;<span class="variable">$heic_file</span>&quot;</span> -resize <span class="string">&quot;<span class="variable">$heic_resolution</span>&quot;</span> <span class="string">&quot;<span class="variable">$output_file</span>&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Converted <span class="variable">$heic_file</span> to <span class="variable">$output_file</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert MOV to MP4 or mov to mp4 using ffmpeg</span></span><br><span class="line"><span class="keyword">for</span> mov_file <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$input_dir</span>&quot;</span>/*.[Mm][Oo][Vv]; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="string">&quot;<span class="variable">$mov_file</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        base_name=<span class="string">&quot;<span class="subst">$(basename <span class="string">&quot;<span class="variable">$mov_file</span>&quot;</span> | sed &#x27;s/\(.*\)\.[Mm][Oo][Vv]/\1/&#x27;)</span>&quot;</span></span><br><span class="line">        ext=<span class="string">&quot;<span class="subst">$(basename <span class="string">&quot;<span class="variable">$mov_file</span>&quot;</span> | sed &#x27;s/.*\.\([Mm][Oo][Vv]\)/\1/&#x27;)</span>&quot;</span></span><br><span class="line">        <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$ext</span>&quot;</span> == <span class="string">&quot;MOV&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            output_ext=<span class="string">&quot;MP4&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$ext</span>&quot;</span> == <span class="string">&quot;mov&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            output_ext=<span class="string">&quot;mp4&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        output_file=<span class="string">&quot;<span class="variable">$output_dir</span>/<span class="variable">$base_name</span>.<span class="variable">$output_ext</span>&quot;</span></span><br><span class="line">        ffmpeg -i <span class="string">&quot;<span class="variable">$mov_file</span>&quot;</span> -vf <span class="string">&quot;scale=<span class="variable">$mov_resolution</span>&quot;</span> -c:v libx264 -c:a aac -strict experimental <span class="variable">$verbosity</span> <span class="string">&quot;<span class="variable">$output_file</span>&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Converted <span class="variable">$mov_file</span> to <span class="variable">$output_file</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy files with other extensions</span></span><br><span class="line"><span class="keyword">for</span> other_file <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$input_dir</span>&quot;</span>/*; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="string">&quot;<span class="variable">$other_file</span>&quot;</span> ] &amp;&amp; ! [[ <span class="string">&quot;<span class="variable">$other_file</span>&quot;</span> =~ \.[Hh][Ee][Ii][Cc]$|\.[Mm][Oo][Vv]$ ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">cp</span> <span class="string">&quot;<span class="variable">$other_file</span>&quot;</span> <span class="string">&quot;<span class="variable">$output_dir</span>/<span class="subst">$(basename <span class="string">&quot;<span class="variable">$other_file</span>&quot;</span>)</span>&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Copied <span class="variable">$other_file</span> to <span class="variable">$output_dir</span>/<span class="subst">$(basename <span class="string">&quot;<span class="variable">$other_file</span>&quot;</span>)</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Conversion and copying complete.&quot;</span></span><br></pre></td></tr></table></figure>

<p>The script can be used as follows. It will convert HEIC/MOV files to JPEG/MP4 files and copy other files directly. The format extension letter case is preserved. The user can also specify the resolutions for the converted JPEG/MP4 files.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ bash convert.sh -i example-inputs -o example-outputs -hr 2048x1536 -mr 1280x720</span><br><span class="line">Converted example-inputs/IMG_8554.HEIC to example-outputs/IMG_8554.JPEG</span><br><span class="line">Converted example-inputs/IMG_8555.HEIC to example-outputs/IMG_8555.JPEG</span><br><span class="line">Converted example-inputs/IMG_8556.HEIC to example-outputs/IMG_8556.JPEG</span><br><span class="line">Converted example-inputs/IMG_8559.HEIC to example-outputs/IMG_8559.JPEG</span><br><span class="line">Converted example-inputs/IMG_8560.heic to example-outputs/IMG_8560.jpeg</span><br><span class="line">Converted example-inputs/IMG_8557.MOV to example-outputs/IMG_8557.MP4</span><br><span class="line">Converted example-inputs/IMG_8558.MOV to example-outputs/IMG_8558.MP4</span><br><span class="line">Converted example-inputs/IMG_8595.mov to example-outputs/IMG_8595.mp4</span><br><span class="line">Copied example-inputs/KICA-2505.jpg to example-outputs/KICA-2505.jpg</span><br><span class="line">Conversion and copying complete.</span><br></pre></td></tr></table></figure>

<h2 id="Conclusions"><a href="#Conclusions" class="headerlink" title="Conclusions"></a>Conclusions</h2><p>Some stupid product designs sometimes changed features that have already been nearly optimum. People should not do stupid things simply because they get paid and have to do something which turns out to be completely useless.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.reddit.com/r/iCloud/comments/16v0q2j/icloud_photos_defaulting_to_zipheic_download_in/">iCloud Photos Defaulting to ZIP/HEIC Download in Browser</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion</p><p><a href="https://levanliu.github.io/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/">https://levanliu.github.io/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Lei Mao</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>10-11-2023</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>10-11-2023</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <div><a class="link-muted" rel="tag" href="/tags/Apple/">Apple,</a> </div><div><a class="link-muted" rel="tag" href="/tags/iCloud/">iCloud,</a> </div><div><a class="link-muted" rel="tag" href="/tags/FFMPEG/">FFMPEG,</a> </div><div><a class="link-muted" rel="tag" href="/tags/ImageMagick/">ImageMagick </a> </div></div></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=61b5930d440224001908310c&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered has-text-weight-normal">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="paypal" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="SSVSLEH4X85LU"><input type="hidden" name="currency_code" value="USD"></form><a class="button donate" href="https://www.buymeacoffee.com/levanliu" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/life/Brushy-Peak-Regional-Preserve/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Brushy Peak Regional Preserve 徒步</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blog/California-Evil-Leaf-Blowers/"><span class="level-item">California Evil Leaf Blowers</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comment-card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="comment-block"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://levanliu.github.io/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/';
            this.page.identifier = '/blog/iCloud-Bash-Script-HEIC-MOV-To-JPEG-MP4/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'levanliu-github-io' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/author_images/Lei-Bio-Medium.jpg" alt="Lei Mao"></figure><p class="title is-size-4 is-block" style="line-height:inherit;margin-bottom:0.30rem;">Lei Mao</p><p class="is-block" style="white-space: pre-line; font-style: italic; margin-bottom: 0.50rem; font-size: 0.8em">Artificial Intelligence
Machine Learning
Computer Science
</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Santa Clara, California</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">733</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">453</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/levanliu" target="_blank" rel="noopener"><i class="fab fa-github"></i>  Follow</a> <a class="level-item button is-primary is-rounded" href="https://github.com/sponsors/levanliu" target="_blank" rel="noopener"><i class="fas fa-heart"></i>  Sponsor</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/levanliu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/matchalevanliu"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/lei-mao/"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:dukelevanliu@gmail.com"><i class="fas fa-envelope-square"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="G.Scholar" href="https://scholar.google.com/citations?user=R2VUf7YAAAAJ"><i class="ai ai-google-scholar-square"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Introduction"><span class="level-left"><span class="level-item">1</span><span class="level-item">Introduction</span></span></a></li><li><a class="level is-mobile" href="#iCloud-HEIC-MOV-To-JPEG-MP4-Bash-Script-Conversion"><span class="level-left"><span class="level-item">2</span><span class="level-item">iCloud HEIC/MOV To JPEG/MP4 Bash Script Conversion</span></span></a></li><li><a class="level is-mobile" href="#Conclusions"><span class="level-left"><span class="level-item">3</span><span class="level-item">Conclusions</span></span></a></li><li><a class="level is-mobile" href="#References"><span class="level-left"><span class="level-item">4</span><span class="level-item">References</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget"><div class="g-ads-x"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3></div><br><center><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDCK3L&amp;placement=levanliugithubio" id="_carbonads_js"></script></center></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/favicon/android-chrome-512x512.png" alt="Lei Mao&#039;s Log Book" height="28"></a><p class="is-size-7"><span>&copy; 2017-2024 Lei Mao</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Site UV: <span id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></span></span> <span id="busuanzi_container_site_pv">Site PV: <span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span></span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/levanliu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>